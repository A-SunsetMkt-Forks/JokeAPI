## JokeAPI v3 

### Problems with v2:
- Usage
  - safe mode should have been opt-out from the beginning
  - joke format
    - IDs are always sequential and thus could change (which defeats the purpose of an ID)
    - blacklist flags don't allow for "positive" or "whitelist" flags
    - single category
    - category aliases that were added cause I wanted to rename one category
    - not enough blacklist flags; too much ambiguity
    - joke language doesn't consider locales
- Development
  - JS and CommonJS instead of TS
  - too much usage of native modules which led to too much DIY
  - overcomplicated APIs
    - class-based endpoints system
    - class-based joke filter
  - half-assed and broken analytics
  - DIY translations
    - too much stuff is translated
  - too much deviation from standards
    - invalid auth token format
    - wonky DIY HTTP headers
  - pretty bad error logging
  - DIY rate limiting instead of leveraging nginx or something
- Submission system
  - submissions get spammed
  - duplicates or "people falling asleep on the keyboard" isn't preemptively filtered out
  - CLI-based tools are clunky and unstable
  - editing and reformatting submissions is abysmal
  - no additional moderators can be added without granting full SSH privileges
  - no "code of conduct" / submission guidelines for users
- File-based operations
  - slow
  - prone to failure (when accessed multiple times at once)
  - too much DIY
- Documentation
  - oh god oh fuck please make it stop
  - vanilla JS and HTML?????? what the fuck was I thinking?????????
  - just way too much work to update
- No monetization
- Too open of a license
- Missing communication with contributors / wrapper devs
  - Wrapper devs are just as surprised as all other users that a new version is out

<br>

### What v3 should do better:
- Usage
  - make safe mode opt-out instead of opt-in
  - joke format
    - assign IDs once and don't change them after
    - generalize blacklist flags
    - allow multiple categories in jokes and expand on them to have them be a kind of "whitelist flag"
    - don't add category aliases, instead give them a good name from the start
    - add more blacklist flags
    - support submitting and querying jokes with both a 2-character language code (en) and a 5-character locale code (en-US)
      - if a joke is queried for with a 2-char code, jokes from all locales matching that language will be considered
      - if a joke is submitted with a 2-char code, it will show up in queries that specified a 5-char locale code that includes the matching language
- Development
  - use TS instead of JS
  - libraries to use:
    - an actual logging lib -> [winston](https://www.npmjs.com/package/winston)
      - logging backend -> [graylog](https://www.graylog.org/products/source-available/)
      - logging backend plugin -> [winston-graylog2](https://www.npmjs.com/package/@eximius/winston-graylog2)
    - an actual analytics lib -> [analytics](https://www.npmjs.com/package/analytics)
    - express for the REST stuff
      - CORS and helmet plugins
    - i18next for translations
      - only translate necessary stuff
    - node-pm or cluster-service to cluster JokeAPI across multiple cores, improving performance
  - research and stick to HTTP standards
  - think about increasing the ratelimit timeframe to something like a day to incentivise the paid tier(s)
- Submissions
  - add an extra website
    - any user can submit jokes
    - any user can vote on jokes
    - any user can propose an edit to submissions
    - moderators can do a final reformatting and accept or deny the submission
    - users have to accept the submission guidelines before submitting
    - users have to sign away their rights to the joke before submitting
  - pre-filtering when accepting submissions on the server
    - prevent exact or fuzzy duplicates from being submitted
    - filter out keyboard diarrhoea submissions
    - maybe some NLP library can be used to filter and automatically deny and even pre-flag some submissions through sentiment analysis
      - https://github.com/axa-group/nlp.js
- File-based operations
  - instead of JSON files, use Postgres with Prisma
    - way faster
    - less resource heavy
    - queries are easy enough to write
- Documentation
  - research tooling to make this easier
  - use an actual web framework this time ðŸ™ƒ
    - maybe a documentation generator or toolkit
  - make it actually look half-way acceptable
- Monetization
  - add multiple tiers
    - different rate limit budgets
    - maybe the more advanced filters should be paywalled (I hate this as much as anyone but I really need to be paid)
  - maybe ads on the documentation?
  - TODO: think of more ways to incentivise paid tiers
    - enable joke ID caching for paid clients, so that they may never receive the same joke(s) consecutively
    - allow only paid clients to use some of the more resource heavy filtering methods
- Use a more restrictive license than MIT
  - AGPL3?
- Communication with contributors / wrapper devs
  - Have a mailing list and special Discord role for wrapper devs and contributors for internal updates
  - Have a staging version of the API out that is updated automatically so it isn't forgotten about again
